\startenvironment env_document

% \usepath[{mathe, mathe/unterricht}]

\startluacode
function include_markdown_files(directory, template)
	local lfs = require("lfs")
	for file in lfs.dir(directory) do
		if file:match("%.md$") then
			context("\\processmarkdownfile[template=" .. template .."]{" .. directory .. "/" .. file .."}")
		end
	end
end
\stopluacode


% \setupinteractionscreen[option=bookmark]
\setuppapersize[A4]

\setupinteraction                                           
  [state=start,                                             % enable hyperlinks
   color=niv3color]                            % choose the color of hyperlinks

\placebookmarks 
  [chapter,section,subsection]   % make bookmarks visible when opening document
  [chapter,section,subsection]   % select unfolded levels when opening document
  
\setupinteractionscreen
  [option=bookmark,nomenubar]

% Headers and footers setup
\setupheader[style=normal, location=middle]
\setupheadertexts[{\getmarking[section]}] % This will place the current section title in the header
\setupfooter[style=normal, location=middle]
\setupfootertexts[] % Empty initially to suppress page numbers

% Suppress page numbers initially across the document
\setuppagenumbering[location=none]

% A new ToC title
\setupheadtext[content=All my contents]

% turn off numbering of some levels
% \setuphead[subsection][number=no]
% \setuphead[subsubsection][number=no]

% ToC
% alternative=c, space to the page number is filled with dots
\setupcombinedlist[content][list={chapter,section,subsection}, alternative=c,]
% in MkII replace list with level=4: \subsubsubsections are not listed in ToC

%\setuplist[chapter][width=5mm, style=bold]
\setuplist[section][width=10mm, style=bold]
% \setuplist[subsection][width=20mm]

% pagestyle=normal for changing the appearance of pagenumber
\setuplist[subsubsection][width=20mm, style=slanted, pagestyle=normal]


% make chapter, section bookmarks visible when opening document
\placebookmarks[chapter, section, subsection, subsubsection, subsubsubsection, subsubsubsubsection][chapter, section]
\setupinteractionscreen[option={bookmark,title}]


\setupitemize[autointro]    % prevent orphan list intro
\setupitemize[indentnext=no]

\defineitemgroup[enumerate]
\setupenumerate[each][fit][itemalign=left,distance=.5em,style={\feature[+][default:tnum]}]

\setupfloat[figure][default={here,nonumber}]
\setupfloat[table][default={here,nonumber}]

\setupxtable[frame=off]
\setupxtable[head][topframe=on]
\setupxtable[body][]
\setupxtable[foot][]
\setupxtable[lastrow][bottomframe=on]


% Setup the title page
\unprotect

% \setups[namespace:set] is automatically called right after 'set' is assigned
\setvariables[meta]
  [title={Schul Notizen},
   subtitle={Abitur 2025},
   date={},
   author={Niklas von Hirschfeld},
  ]
  

\def\MyTitlePage{
\startalignment[middle]
    \definedfont[SerifBold at 24pt]
	\getvariable{meta}{title}
    \blank[3*line]
    \definedfont[Serif at 18pt]
	\getvariable{meta}{subtitle}
    \blank[2*line]
	\getvariable{meta}{author}
\stopalignment

}

\protect

\stopenvironment
